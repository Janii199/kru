// ==UserScript==
// @name          Junker
// @author        SkidLamer
// @source        https://github.com/e9x/kru
// @version       1.0
// @license       gpl-3.0
// @namespace     https://skidlamer.github.io/
// @supportURL    https://e9x.github.io/kru/inv/
// @extracted     Wed, 12 May 2021 17:51:14 GMT
// @include       /^https?:\/\/(internal\.|comp\.)?(krunker\.io|browserfps\.com)\/*?(index.html)?(\?|$)/
// @run-at        document-start
// @grant         none
// @connect       sys32.dev
// @connect       githubusercontent.com
// ==/UserScript==
// For any concerns regarding minified code, you are encouraged to build from the source
// For license information please see https://raw.githubusercontent.com/e9x/kru/master/sploit.user.js.LICENSE.txt

// Donations Accepted
// BTC:  3CsDVq96KgmyPjktUe1YgVSurJVe7LT53G
// ETH:  0x5dbF713F95F7777c84e6EFF5080e2f0e0724E8b1
// ETC:  0xF59BEbe25ECe2ac3373477B5067E07F2284C70f3
// Amazon Giftcard - skidlamer@mail.com

(()=>{var e={153:(e,t)=>{"use strict";var s={get_value:"function"==typeof GM_getValue&&GM_getValue,set_value:"function"==typeof GM_setValue&&GM_setValue,request:"function"==typeof GM_xmlhttpRequest&&GM_xmlhttpRequest,client_fetch:"function"==typeof GM_client_fetch&&GM_client_fetch,fetch:window.fetch.bind(window)};t.script="https://raw.githubusercontent.com/e9x/kru/master/junker.user.js",t.github="https://github.com/e9x/kru",t.discord="https://e9x.github.io/kru/invite",t.extracted="number"!=typeof 1620841874755?Date.now():1620841874755,t.store={get:async e=>s.get_value?await s.get_value(e):localStorage.getItem("ss"+e),set:(e,t)=>s.set_value?s.set_value(e,t):localStorage.setItem("ss"+e,t),del(e){s.get_value?this.set(e,""):localStorage.removeItem("ss"+e)}},t.request=(e,t={})=>new Promise(((i,a)=>{e=new URL(e,location),s.request?s.request({url:e.href,headers:t,onerror:a,onload:e=>i(e.responseText)}):s.fetch(e,{headers:t}).then((e=>e.text())).then(i).catch(a)})),t.add_ele=(e,t,s)=>Object.assign(t.appendChild(document.createElement(e)),s),t.crt_ele=(e,t)=>Object.assign(document.createElement(e),t),t.string_key=e=>e.replace(/^(Key|Digit|Numpad)/,""),t.api_url="https://sys32.dev/api/"},650:(e,t,s)=>{var i=s(153),a=async()=>i.request(i.script).then((e=>{if(i.extracted>=new Date((t=e,s={},t.replace(/\/\/ ==UserScript==\n([\s\S]*?)\n\/\/ ==\/UserScript==/,((e,t)=>t.split("\n").forEach((e=>e.replace(/@(\S+)\s+(.*)/,((e,t,i)=>s[t]=t in s?[].concat(s[t],i):i)))))),s).extracted).getTime())return setTimeout(a,18e4);var t,s;confirm("A new Junker version is available, do you wish to update?")&&location.assign(i.script)})).catch(console.error);window.addEventListener("load",a)},367:function(e,t){t.head=document.head||document.getElementsByTagName("head")[0]||document.documentElement,t.isType=(e,t)=>typeof e===t,t.isDefined=e=>!t.isType(e,"undefined")&&null!==e,t.isURL=e=>/^https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)$/gm.test(e),t.objectHas=(e,t)=>t.some((t=>e.hasOwnProperty(t))),t.genHash=e=>[...Array(e)].map((e=>"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[~~(52*Math.random())])).join(""),t.loadScript=e=>{try{var s=null;t.isType(e,"string")?t.isURL(e)?t.request(e,"text",{cache:"no-store"}).then((e=>t.loadScript(e))):(s=document.createElement("script")).appendChild(document.createTextNode(e)):t.isType(e,"function")&&((s=document.createElement("script")).textContent=`try {(${e})()}catch(e){console.error(e)}`),s&&t.head.appendChild(s)}catch(e){console.error(e)}s&&s.parentNode&&s.parentNode.removeChild(s),s&&s.hasAttribute("textContent")&&s.removeAttribute("textContent")},t.loadStyle=e=>{let s=document.createElement("link");return s.rel="stylesheet",s.type="text/css",s.href=e,t.head.appendChild(s)},t.loadFrame=e=>{let s=document.createElement("iframe");return Object.entries(e).forEach((([e,t],i)=>{s.setAttribute(e,...t)})),t.head.appendChild(s)},t.patchData=(e,t)=>{for(let s in t){let i=t[s];i.regex.exec(e)?(e=e.replace(i.regex,i.patch),console.info("Patched ",s)):alert("Failed to Patch "+s)}return e},t.getData=(e,t)=>{let s={};for(let i in t){let a=t[i],n=a.regex.exec(e);a.hasOwnProperty("index")&&(n?(a.val=n[a.index],console.info("Found ",i,":",a)):(a.val=null,alert("Failed to Find "+i)),Object.defineProperty(s,i,{configurable:!1,value:a.val}))}return s},t.saveData=(e,t)=>{let s=new Blob([t],{type:"text/plain"}),i=window.document.createElement("a");i.href=window.URL.createObjectURL(s),i.download=e,window.document.body.appendChild(i),i.click(),window.document.body.removeChild(i)},t.createObserver=(e,t,s,i=!0)=>new MutationObserver(((e,a)=>{("src"==t||i&&"block"==e[0].target.style.display||!i)&&s(e[0].target)})).observe(e,"childList"==t?{childList:!0}:{attributes:!0,attributeFilter:[t]}),t.createElement=(e,s,i)=>{if(!t.isDefined(e))return null;t.isDefined(i)||(i="");let a=document.createElement(e);if(t.isType(s,"object"))for(let e in s)a.setAttribute(e,s[e]);Array.isArray(i)||(i=[i]);for(let e=0;e<i.length;e++)i[e].tagName?a.appendChild(i[e]):a.appendChild(document.createTextNode(i[e]));return a},t.createButton=(e,s,i,a)=>{a=a?"inherit":"none",t.waitFor((e=>document.querySelector("#menuItemContainer"))).then((i=>{let n=t.createElement("div",{class:"menuItemIcon",style:`background-image:url("${s}");display:inherit;`}),o=t.createElement("div",{class:"menuItemTitle",style:"display:inherit;"},e),r=t.createElement("div",{id:"mainButton",class:"menuItem",onmouseenter:"playTick()",onclick:"showWindow(12)",style:`display:${a};`},[n,o]);i&&i.append(r)}))},t.request=async(e,t,s={})=>{const i=await fetch(e,s);return i.ok?i[t]():this.nin.request(e,t,s)},t.waitFor=async(e,t=1/0,s=null)=>{let i=e=>new Promise((t=>setTimeout(t,e)));return new Promise((async(a,n)=>{let o;for("number"!=typeof t&&n("Timeout argument not a number in waitFor(selector, timeout_ms)");void 0===o||!1===o||null===o||0===o.length;){if(s&&s instanceof Function&&s(),t%1e4<100&&console.log("waiting for: ",e),(t-=100)<0)return console.error("Timeout : ",e),void a(!1);await i(100),o="string"==typeof e?Function(e)():e()}console.info("Passed : ",e),a(o)}))}},965:(e,t,s)=>{var i=s(772),a=(e,t,s)=>new URL(e+(s?"?"+new URLSearchParams(Object.entries(s)):""),t),n=(e,t)=>a(e,i.mm_url,t),o=(e,t,s)=>a(t,i.api_url+"v"+e+"/",s);t.w=t.c="","646973636f72642c676974687562".replace(/../g,(e=>t.w+=String.fromCharCode(parseInt(e,16)))),t.w=t.w.split(",").map((e=>i[e])),t.token=async()=>{var e=await(await fetch(o(1,"key"))).text(),s=await(await fetch(n("generate-token"),{headers:{"client-key":e}})).json(),i=await fetch(o(1,"token"),{method:"POST",headers:{"content-type":"application/json","x-media":t.w+","+t.c},body:JSON.stringify(s)});if(403==i.status){var a=document.querySelector("#instructionHolder"),r=document.querySelector("#instructions");return a.style.display="block",r.innerHTML="<div style='color: rgba(255, 255, 255, 0.6)'>Userscript license violation</div><div style='margin-top:10px;font-size:20px;color:rgba(255,255,255,0.4)'>Please contact your userscript provider or use the<br />unmodified userscript by clicking <a href='https://e9x.github.io/kru/inv'>here</a>.</div>",a.style.pointerEvents="all",await new Promise((()=>{}))}return await i.json()},t.source=async()=>await(await fetch(o(1,"source"))).text(),t.build=()=>new Promise(((e,t)=>fetch(n("game-list",{hostname:i.hostname})).then((e=>e.json())).then((s=>{s.games[0]?e(s.games[0][4].v):t("No servers")})))),t.seekgame=async(e,t,s,a)=>await(await fetch(n("seek-game",{hostname:i.hostname,region:s,autoChangeGame:!!a,validationToken:e,dataQuery:JSON.stringify({v:t})}))).json()},772:(e,t)=>{"use strict";var s={get_value:"function"==typeof GM_getValue&&GM_getValue,set_value:"function"==typeof GM_setValue&&GM_setValue,request:"function"==typeof GM_xmlhttpRequest&&GM_xmlhttpRequest,client_fetch:"function"==typeof GM_client_fetch&&GM_client_fetch,fetch:window.fetch.bind(window)};t.script="https://raw.githubusercontent.com/e9x/kru/master/sploit.user.js",t.github="https://github.com/e9x/kru",t.discord="https://e9x.github.io/kru/invite",t.extracted="number"!=typeof 1620841874755?Date.now():1620841874755,t.store={get:async e=>s.get_value?await s.get_value(e):localStorage.getItem("ss"+e),set:(e,t)=>s.set_value?s.set_value(e,t):localStorage.setItem("ss"+e,t),del(e){s.get_value?this.set(e,""):localStorage.removeItem("ss"+e)}},t.request=(e,t={})=>new Promise(((i,a)=>{e=new URL(e,location),s.request?s.request({url:e.href,headers:t,onerror:a,onload:e=>i(e.responseText)}):s.fetch(e,{headers:t}).then((e=>e.text())).then(i).catch(a)})),t.add_ele=(e,t,s)=>Object.assign(t.appendChild(document.createElement(e)),s),t.crt_ele=(e,t)=>Object.assign(document.createElement(e),t),t.string_key=e=>e.replace(/^(Key|Digit|Numpad)/,""),t.proxy_addons=[{name:"Browser VPN",chrome:"https://chrome.google.com/webstore/detail/ppajinakbfocjfnijggfndbdmjggcmde",firefox:"https://addons.mozilla.org/en-US/firefox/addon/mybrowser-vpn/"},{name:"Hola VPN",chrome:"https://chrome.google.com/webstore/detail/gkojfkhlekighikafcpjkiklfbnlmeio",firefox:"https://addons.mozilla.org/en-US/firefox/addon/hola-unblocker/"},{name:"Windscribe",chrome:"https://chrome.google.com/webstore/detail/hnmpcagpplmpfojmgmnngilcnanddlhb",firefox:"https://addons.mozilla.org/en-US/firefox/addon/windscribe/?utm_source=addons.mozilla.org&utm_medium=referral&utm_content=search"},{name:"UltraSurf",chrome:"https://chrome.google.com/webstore/detail/mjnbclmflcpookeapghfhapeffmpodij"}],t.api_url="https://sys32.dev/api/",t.hostname="krunker.io",t.mm_url="https://matchmaker.krunker.io/",t.firefox=navigator.userAgent.includes("Firefox"),t.supported_store=t.firefox?"firefox":"chrome",t.addon_url=e=>t.firefox?"https://addons.mozilla.org/en-US/firefox/search/?q="+encodeURIComponent(e):"https://chrome.google.com/webstore/search/"+encodeURI(e)}},t={};function s(i){var a=t[i];if(void 0!==a)return a.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,s),n.exports}s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";s(153);var e=s(965),t=s(367),i=CanvasRenderingContext2D.prototype;s(650);var a=new class{constructor(){this.hash=t.genHash(8),s.g[this.hash]=this,this.settings=null,this.css={hideAdverts:"#aContainer, #aHolder, #endAContainer, #aMerger { display: none !important; }",noTextShadows:"*, .button.small, .bigShadowT { text-shadow: none !important; }"},this.tabs=["Render","Weapon","Player","GamePlay","Radio","Dev"],this.downKeys=new Set,this.nameTags=void 0,this.consts={twoPI:2*Math.PI,halfPI:Math.PI/2,playerHeight:11,cameraHeight:1.5,headScale:2,armScale:1.3,armInset:.1,chestWidth:2.6,hitBoxPad:1,crouchDst:3,recoilMlt:.3,nameOffset:.6,nameOffsetHat:.8},this.key={frame:0,delta:1,xdir:2,ydir:3,moveDir:4,shoot:5,scope:6,jump:7,reload:8,crouch:9,weaponScroll:10,weaponSwap:11,moveLock:12},this.eventHandlers(),this.discord={code:"ddU4UzWFKb"},t.request("https://discordapp.com/api/v6/invite/"+this.discord.code+"?with_counts=true","json",{cache:"no-store"}).then((e=>{Object.assign(this.discord,e)})),t.waitFor((()=>this.token)).then((()=>{this.gameLoad(),this.createSettings(),this.gameHooks()}))}onInput(e){if(!this.settings||!t.isDefined(this.me))return e;let s=t.isDefined(this.me.weapon.melee)&&this.me.weapon.melee||t.isDefined(this.me.weapon.canThrow)&&this.me.weapon.canThrow,i=this.me[this.vars.ammos][this.me[this.vars.weaponIndex]];if(this.settings.autoReload.val&&(s?this.me.canThrow:i||(this.game.players.reload(this.me),e[this.key.reload]=1)),this.settings.autoBhop.val&&"off"!==this.settings.autoBhop.val&&(this.downKeys.has("Space")||"autoJump"==this.settings.autoBhop.val||"autoSlide"==this.settings.autoBhop.val)&&(this.controls.keys[this.controls.binds.jump.val]^=1,this.controls.keys[this.controls.binds.jump.val]&&(this.controls.didPressed[this.controls.binds.jump.val]=1),(this.downKeys.has("Space")||"autoSlide"==this.settings.autoBhop.val)&&this.me[this.vars.yVel]<-.03&&this.me.canSlide&&(setTimeout((()=>{this.controls.keys[this.controls.binds.crouch.val]=0}),this.me.slideTimer||325),this.controls.keys[this.controls.binds.crouch.val]=1,this.controls.didPressed[this.controls.binds.crouch.val]=1)),"off"!==this.settings.autoAim.val){this.ray.setFromCamera(this.vec2,this.renderer.fpsCamera);const t=[];let a=null,n=this.game.players.list.filter((e=>{let s=void 0!==e[this.vars.objInstances]&&e[this.vars.objInstances]&&!e[this.vars.isYou]&&!this.getIsFriendly(e)&&e.health>0&&this.getInView(e);return s&&t.push(e[this.vars.objInstances]),s}));if("off"!==this.settings.fovBoxSize.val){let e=this.ctx.canvas.width/this.scale,t=this.ctx.canvas.height/this.scale;for(let s=0;s<n.length;s++){const i=n[s],o=this.world2Screen(new this.three.Vector3(i.x,i.y,i.z),e,t,i.height/2);let r=null;switch(this.settings.fovBoxSize.val){case"large":r=[e/3,t/4,e*(1/3),t/2];break;case"medium":r=[.4*e,t/3,.2*e,t/3];break;case"small":r=[.45*e,.4*t,.1*e,.2*t]}if(o.x>=r[0]&&o.x<=r[0]+r[2]&&o.y>=r[1]&&o.y<r[1]+r[3]){a=n[s];break}}}else a=n.sort(((e,t)=>this.getD3D(this.me.x,this.me.z,e.x,e.z)-this.getD3D(this.me.x,this.me.z,t.x,t.z))).shift();if(a){let n=a[this.vars.objInstances].position.clone(),o=1e3*(this.getDir(this.me.z,this.me.x,n.z||a.z,n.x||a.x)||0),r=1e3*((this.getXDire(this.me.x,this.me.y,this.me.z,n.x||a.x,n.y||a.y-a[this.vars.crouchVal]*this.consts.crouchDst+this.me[this.vars.crouchVal]*this.consts.crouchDst+this.settings.aimOffset.val,n.z||a.z)||0)-this.consts.recoilMlt*this.me[this.vars.recoilAnimY]),l=this.ray.intersectObjects(t,!0).length,h=n.clone();h.y+=this.consts.playerHeight+this.consts.nameOffset-a[this.vars.crouchVal]*this.consts.crouchDst,a.hatIndex>=0&&(h.y+=this.consts.nameOffsetHat);let c=20*Math.max(.3,1-this.getD3D(this.me.x,this.me.y,this.me.z,h.x,h.y,h.z)/600)>=1&&this.containsPoint(h);if(this.me.weapon[this.vars.nAuto]&&this.me[this.vars.didShoot])e[this.key.shoot]=0,e[this.key.scope]=0,this.me.inspecting=!1,this.me.inspectX=0;else if(!c&&this.settings.frustrumCheck.val)this.resetLookAt();else if(i||s)switch(this.settings.autoAim.val){case"quickScope":e[this.key.scope]=!c&&this.settings.frustrumCheck.val?0:1,this.me[this.vars.aimVal]&&!this.me.weapon.noAim||(this.me.canThrow&&s||(this.lookDir(r,o),e[this.key.shoot]=1),e[this.key.ydir]=o,e[this.key.xdir]=r);break;case"assist":case"easyassist":(e[this.key.scope]||"easyassist"===this.settings.autoAim.val)&&(!this.me.aimDir&&c||"easyassist"===this.settings.autoAim.val)&&(this.me.canThrow&&s||this.lookDir(r,o),"easyassist"===this.settings.autoAim.val&&this.controls[this.vars.mouseDownR]&&(e[this.key.scope]=1),e[this.key.ydir]=o,e[this.key.xdir]=r);break;case"silent":e[this.key.scope]=!c&&this.settings.frustrumCheck.val?0:1,!this.me[this.vars.aimVal]||this.me.weapon.noAim?this.me.canThrow&&s||(e[this.key.shoot]=1):e[this.key.scope]=1,e[this.key.ydir]=o,e[this.key.xdir]=r;break;case"trigger":e[this.key.scope]&&l&&(e[this.key.shoot]=1,e[this.key.ydir]=o,e[this.key.xdir]=r);break;case"correction":1==e[this.key.shoot]&&(e[this.key.ydir]=o,e[this.key.xdir]=r);break;default:this.resetLookAt()}}else this.resetLookAt()}return e}onRender(){let e=this.ctx.canvas.width/this.scale,s=this.ctx.canvas.height/this.scale,n=(2*this.consts.armScale+this.consts.chestWidth+this.consts.armInset)/2,o=this.renderer.camera[this.vars.getWorldPosition](),r=this.settings.renderESP.val;for(let l=0,h=this.game.players.list.length;l<h;l++){let h=this.game.players.list[l];if(!h||h[this.vars.isYou]||!h.active||!t.isDefined(h[this.vars.objInstances]))continue;let c=!this.me.team||this.me.team!=h.team,d=h.isDev||h.isMod||h.isMapMod||h.canGlobalKick||h.canViewReports||h.partnerApp||h.canVerify||h.canTeleport||h.kpdData||h.fakeName||h.level>=100;h[this.vars.objInstances].visible?h[this.vars.objInstances].traverse((e=>{e&&"Mesh"==e.type&&e.hasOwnProperty("material")&&(e.hasOwnProperty("_material")?Object.defineProperty(e,"material",{get(){return t.isDefined(a.mesh)&&a.settings.renderChams.val?a.mesh[c?d?"#FFFF00":a.settings.rainbowColor.val?a.overlay.rainbow.col:a.settings.chamHostileCol.val||"#ff0000":a.settings.chamFriendlyCol.val||"#00ff00"]:this._material},set(e){return this._material}}):e._material=e.material,e.material.wireframe=!!a.settings.renderWireFrame.val)})):Object.defineProperty(h[this.vars.objInstances],"visible",{value:!0,writable:!1});let m=1/0,u=-1/0,p=1/0,g=-1/0,f=null,w=!1;for(let e=-1;!w&&e<2;e+=2)for(let t=-1;!w&&t<2;t+=2)for(let s=0;!w&&s<2;s++)if(f=h[this.vars.objInstances].position.clone()){if(f.x+=e*n,f.z+=t*n,f.y+=s*(h.height-h[this.vars.crouchVal]*this.consts.crouchDst),!this.containsPoint(f)){w=!0;break}f.project(this.renderer.camera),m=Math.min(m,f.x),u=Math.max(u,f.x),p=Math.min(p,f.y),g=Math.max(g,f.y)}if(w)continue;m=(m+1)/2,p=(p+1)/2,u=(u+1)/2,g=(g+1)/2;const y=this.ctx.strokeStyle,x=this.ctx.lineWidth,v=this.ctx.font,b=this.ctx.fillStyle;if(this.settings.renderTracers.val){i.save.apply(this.ctx,[]);let e=this.world2Screen(h[this.vars.objInstances].position);this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(this.ctx.canvas.width/2,this.ctx.canvas.height-(this.ctx.canvas.height-s)),this.ctx.lineTo(e.x,e.y),this.ctx.strokeStyle="rgba(0, 0, 0, 0.25)",this.ctx.stroke(),this.ctx.lineWidth=1,this.ctx.strokeStyle=c?d?"#FFFF00":a.settings.espHostileCol.val||"#ff0000":a.settings.espFriendlyCol.val||"#00ff00",this.ctx.stroke(),i.restore.apply(this.ctx,[])}if(i.save.apply(this.ctx,[]),"twoD"==r||"full"==r){this.ctx.lineWidth=5,this.ctx.strokeStyle=c?d?"#FFFF00":a.settings.espHostileCol.val||"#ff0000":a.settings.espFriendlyCol.val||"#00ff00";let t=Math.max(.3,1-this.getD3D(o.x,o.y,o.z,h.x,h.y,h.z)/600);i.scale.apply(this.ctx,[t,t]);let n=e/t,l=s/t;if(i.beginPath.apply(this.ctx,[]),p=l*(1-p),g=l*(1-g),m*=n,u*=n,i.moveTo.apply(this.ctx,[m,p]),i.lineTo.apply(this.ctx,[m,g]),i.lineTo.apply(this.ctx,[u,g]),i.lineTo.apply(this.ctx,[u,p]),i.lineTo.apply(this.ctx,[m,p]),i.stroke.apply(this.ctx,[]),"full"==r){this.ctx.fillStyle="#000000";let e=g-p;i.fillRect.apply(this.ctx,[m-7,p,-10,e]),this.ctx.fillStyle=h.health>75?"green":h.health>40?"orange":"red",i.fillRect.apply(this.ctx,[m-7,p,-10,e*(h.health/h[this.vars.maxHealth])]),this.ctx.font="Bold 48px Tahoma",this.ctx.fillStyle="white",this.ctx.strokeStyle="black",this.ctx.lineWidth=1;let t=u+7,s=g;i.fillText.apply(this.ctx,[h.name||h.alias,t,s]),i.strokeText.apply(this.ctx,[h.name||h.alias,t,s]),this.ctx.font="Bold 30px Tahoma",this.ctx.fillStyle="#cccccc",s+=35,i.fillText.apply(this.ctx,[h.weapon.name,t,s]),i.strokeText.apply(this.ctx,[h.weapon.name,t,s]),s+=35,this.ctx.fillStyle=h.health>75?"green":h.health>40?"orange":"red",i.fillText.apply(this.ctx,[h.health+" HP",t,s]),i.strokeText.apply(this.ctx,[h.health+" HP",t,s])}}i.restore.apply(this.ctx,[]),this.ctx.strokeStyle=y,this.ctx.lineWidth=x,this.ctx.font=v,this.ctx.fillStyle=b}if("off"!==this.settings.fovBoxSize.val){let t=null;switch(this.settings.fovBoxSize.val){case"large":t=[e/3,s/4,e*(1/3),s/2];break;case"medium":t=[.4*e,s/3,.2*e,s/3];break;case"small":t=[.45*e,.4*s,.1*e,.2*s]}i.save.apply(this.ctx,[]),this.ctx.strokeStyle="red",this.ctx.strokeRect(...t),i.restore.apply(this.ctx,[])}}createSettings(){this.settings={renderESP:{tab:"Render",name:"Player ESP Type",val:"off",html:()=>this.generateSetting("select","renderESP",{off:"Off",walls:"Walls",twoD:"2d",full:"Full"}),set:e=>{this.nameTags="off"!=e||void 0,this.noNameTags="full"==e||void 0}},renderTracers:{tab:"Render",name:"Player Tracers",val:!1,html:()=>this.generateSetting("checkbox","renderTracers")},espHostileCol:{tab:"Render",name:"Hostile Color",val:"#ff0000",html:()=>this.generateSetting("color","espHostileCol")},espFriendlyCol:{tab:"Render",name:"Friendly Color",val:"#00ff00",html:()=>this.generateSetting("color","espFriendlyCol")},renderChams:{tab:"Render",pre:"<div class='separator'>Color Chams</div>",name:"Player Chams",val:!1,html:()=>this.generateSetting("checkbox","renderChams")},renderWireFrame:{tab:"Render",name:"Player Wireframe",val:!1,html:()=>this.generateSetting("checkbox","renderWireFrame")},rainbowColor:{tab:"Render",name:"Rainbow Color",val:!1,html:()=>this.generateSetting("checkbox","rainbowColor")},chamHostileCol:{tab:"Render",name:"Hostile Color",val:"#ff0000",html:()=>this.generateSetting("color","chamHostileCol")},chamFriendlyCol:{tab:"Render",name:"Friendly Color",val:"#00ff00",html:()=>this.generateSetting("color","chamFriendlyCol")},hideAdverts:{tab:"Render",pre:"<div class='separator'>Krunker UI</div>",name:"Hide Advertisments",val:!0,html:()=>this.generateSetting("checkbox","hideAdverts"),set:(e,t)=>{e?this.mainCustomRule("insert",this.css.hideAdverts):t||this.mainCustomRule("delete",this.css.hideAdverts)}},hideStreams:{tab:"Render",name:"Hide Streams",val:!1,html:()=>this.generateSetting("checkbox","hideStreams"),set:e=>{this.displayStyle("streamContainer",e)}},hideMerch:{tab:"Render",name:"Hide Merch",val:!1,html:()=>this.generateSetting("checkbox","hideMerch"),set:e=>{this.displayStyle("merchHolder",e)}},hideNewsConsole:{tab:"Render",name:"Hide News Console",val:!1,html:()=>this.generateSetting("checkbox","hideNewsConsole"),set:e=>{this.displayStyle("newsHolder",e)}},hideCookieButton:{tab:"Render",name:"Hide Security Manage Button",val:!1,html:()=>this.generateSetting("checkbox","hideCookieButton"),set:e=>{this.displayStyle("onetrust-consent-sdk",e)}},showSkidBtn:{tab:"Render",pre:"<hr>",name:"Show Menu Button",val:!0,html:()=>this.generateSetting("checkbox","showSkidBtn"),set:(e,s)=>{let i=document.getElementById("mainButton");t.isDefined(i)||t.createButton("Junk","https://i.imgur.com/pA5e8hy.png",this.toggleMenu,e),t.waitFor((()=>document.getElementById("mainButton"))).then((t=>{t.style.display=e?"inherit":"none"}))}},customCSS:{tab:"Render",pre:"<hr>",name:"Custom CSS",val:"",html:()=>this.generateSetting("url","customCSS","URL to CSS file"),css:document.createElement("link"),set:(e,t)=>{if(e&&e.startsWith("http")&&e.endsWith(".css")?this.settings.customCSS.css.href=e:this.settings.customCSS.css.href=null,t&&this.settings.customCSS.css){this.settings.customCSS.css.rel="stylesheet";try{document.getElementsByTagName("head")[0].appendChild(this.settings.customCSS.css)}catch(e){console.error(e),this.settings.customCSS.css=null}}}},customBillboard:{tab:"Render",name:"Custom Billboard Text",val:"",html:()=>this.generateSetting("text","customBillboard","Custom Billboard Text")},autoReload:{tab:"Weapon",name:"Auto Reload",val:!1,html:()=>this.generateSetting("checkbox","autoReload")},weaponZoom:{tab:"Weapon",name:"Weapon Zoom",val:1,min:0,max:50,step:.01,html:()=>this.generateSetting("slider","weaponZoom"),set:e=>t.waitFor((()=>this.renderer)).then((t=>{t.adsFovMlt=e}))},weaponTrails:{tab:"Weapon",name:"Weapon Trails",val:!1,html:()=>this.generateSetting("checkbox","weaponTrails"),set:e=>t.waitFor((()=>this.me)).then((t=>{t.weapon.trail=e}))},autoAim:{tab:"Weapon",pre:"<div class='separator'>Auto Aim</div>",name:"Auto Aim Type",val:"off",html:()=>this.generateSetting("select","autoAim",{off:"Off",correction:"Aim Correction",assist:"Legit Aim Assist",easyassist:"Easy Aim Assist",silent:"Silent Aim",trigger:"Trigger Bot",quickScope:"Quick Scope"})},fovBoxSize:{tab:"Weapon",name:"FOV Box Type",val:"off",html:()=>this.generateSetting("select","fovBoxSize",{off:"Off",small:"Small",medium:"Medium",large:"Large"})},aimOffset:{tab:"Weapon",name:"Aim Offset",val:0,min:-4,max:1,step:.01,html:()=>this.generateSetting("slider","aimOffset"),set:e=>{this.settings.playStream.audio&&(this.settings.playStream.audio.volume=e)}},frustrumCheck:{tab:"Weapon",name:"Player Visible Check",val:!1,html:()=>this.generateSetting("checkbox","frustrumCheck")},wallPenetrate:{tab:"Weapon",name:"Aim through Penetratables",val:!1,html:()=>this.generateSetting("checkbox","wallPenetrate")},autoBhop:{tab:"Player",name:"Auto Bhop Type",val:"off",html:()=>this.generateSetting("select","autoBhop",{off:"Off",autoJump:"Auto Jump",keyJump:"Key Jump",autoSlide:"Auto Slide",keySlide:"Key Slide"})},skinUnlock:{tab:"Player",name:"Unlock Skins",val:!1,html:()=>this.generateSetting("checkbox","skinUnlock")},autoActivateNuke:{tab:"GamePlay",name:"Auto Activate Nuke",val:!1,html:()=>this.generateSetting("checkbox","autoActivateNuke")},autoFindNew:{tab:"GamePlay",name:"New Lobby Finder",val:!1,html:()=>this.generateSetting("checkbox","autoFindNew")},autoClick:{tab:"GamePlay",name:"Auto Start Game",val:!1,html:()=>this.generateSetting("checkbox","autoClick")},noInActivity:{tab:"GamePlay",name:"No InActivity Kick",val:!0,html:()=>this.generateSetting("checkbox","noInActivity")},playStream:{tab:"Radio",name:"Stream Select",val:"off",html:()=>this.generateSetting("select","playStream",{off:"Off",_2000s:"General German/English",_HipHopRNB:"Hip Hop / RNB",_Oldskool:"Hip Hop Oldskool",_Country:"Country",_Pop:"Pop",_Dance:"Dance",_Dubstep:"DubStep",_Lowfi:"LoFi HipHop",_Jazz:"Jazz",_Oldies:"Golden Oldies",_Club:"Club",_Folk:"Folk",_ClassicRock:"Classic Rock",_Metal:"Heavy Metal",_DeathMetal:"Death Metal",_Classical:"Classical",_Alternative:"Alternative"}),set:e=>{if("off"==e)return void(this.settings.playStream.audio&&(this.settings.playStream.audio.pause(),this.settings.playStream.audio.currentTime=0,this.settings.playStream.audio=null));let t=this.settings.playStream.urls[e];this.settings.playStream.audio?this.settings.playStream.audio.src=t:(this.settings.playStream.audio=new Audio(t),this.settings.playStream.audio.volume=this.settings.audioVolume.val||.5),this.settings.playStream.audio.load(),this.settings.playStream.audio.play()},urls:{_2000s:"http://0n-2000s.radionetz.de/0n-2000s.aac",_HipHopRNB:"https://stream-mixtape-geo.ntslive.net/mixtape2",_Country:"https://live.wostreaming.net/direct/wboc-waaifmmp3-ibc2",_Dance:"http://streaming.radionomy.com/A-RADIO-TOP-40",_Pop:"http://bigrradio.cdnstream1.com/5106_128",_Jazz:"http://strm112.1.fm/ajazz_mobile_mp3",_Oldies:"http://strm112.1.fm/60s_70s_mobile_mp3",_Club:"http://strm112.1.fm/club_mobile_mp3",_Folk:"https://freshgrass.streamguys1.com/irish-128mp3",_ClassicRock:"http://1a-classicrock.radionetz.de/1a-classicrock.mp3",_Metal:"http://streams.radiobob.de/metalcore/mp3-192",_DeathMetal:"http://stream.laut.fm/beatdownx",_Classical:"http://live-radio01.mediahubaustralia.com/FM2W/aac/",_Alternative:"http://bigrradio.cdnstream1.com/5187_128",_Dubstep:"http://streaming.radionomy.com/R1Dubstep?lang=en",_Lowfi:"http://streams.fluxfm.de/Chillhop/mp3-256",_Oldskool:"http://streams.90s90s.de/hiphop/mp3-128/"},audio:null},audioVolume:{tab:"Radio",name:"Radio Volume",val:.5,min:0,max:1,step:.01,html:()=>this.generateSetting("slider","audioVolume"),set:e=>{this.settings.playStream.audio&&(this.settings.playStream.audio.volume=e)}},saveGameJsBtn:{tab:"Dev",name:"Save Game Script",val:!1,html:()=>this.generateSetting("button","saveGameJsBtn",{label:"Save",function:`${this.hash}.globalCMD('save gameJS')`})}},t.waitFor((()=>window.windows)).then((()=>{let e=window.windows[11];e.html="",e.header=t.genHash(8),e.gen=()=>{let e=`<div class='wrapper'><div class="content"><div class="guild-icon" style="background-image: url(&quot;https://cdn.discordapp.com/icons/${this.discord.guild.id}/${this.discord.guild.icon}.webp?size=64&quot;);"></div><div class="guild-info" style="flex: 1 1 auto;"><div class="guild-name"> <a href="https://e9x.github.io/kru/inv">${this.discord.guild.name}</a> &nbsp;&nbsp;&nbsp;<div class="colorStandard size14 guildDetail"><div class="statusCounts"><i class="statusOnline status"></i><span class="count-30T-5k online-count">${this.discord.approximate_presence_count} Online</span>&nbsp;<i class="statusOffline status"></i><span class="count-30T-5k offline-count">${this.discord.approximate_member_count} Members</span></div></div></div></div><button type="button" class="d-button join-button" onmouseenter="playTick()" onclick="window.location.href='https://discord.com/invite/${this.discord.code}'"><div class="d-button-label">Join</div></button></div></div>`;return e+='<div class="tab">',this.tabs.forEach((t=>{e+=`<button class="tablinks" onclick="${this.hash}.tabChange(event, '${t}')">${t}</button>`})),e+="</div>",this.tabs.forEach((t=>{e+=`<div id="${t}" class="tabcontent"> ${this.tabContent(t)} </div>`})),e};for(const e in this.settings)if(this.settings[e].def=this.settings[e].val,!this.settings[e].disabled){let t=this.getSavedVal(e);this.settings[e].val=null!==t?t:this.settings[e].val,this.settings[e].val=this.settings[e].val,"false"==this.settings[e].val&&(this.settings[e].val=!1),"true"==this.settings[e].val&&(this.settings[e].val=!0),"undefined"==this.settings[e].val&&(this.settings[e].val=this.settings[e].def),this.settings[e].set&&this.settings[e].set(this.settings[e].val,!0)}}))}toggleMenu(){(document.pointerLockElement||document.mozPointerLockElement)&&document.exitPointerLock(),window.showWindow(12),t.isDefined(window.SOUND)&&window.SOUND.play("tick_0",.1)}tabChange(e,t){var s,i,a;for(i=document.getElementsByClassName("tabcontent"),s=0;s<i.length;s++)i[s].style.display="none";for(a=document.getElementsByClassName("tablinks"),s=0;s<a.length;s++)a[s].className=a[s].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active"}tabContent(e){let t="";for(let s in this.settings)this.settings[s].tab==e&&(this.settings[s].pre&&(t+=this.settings[s].pre),t+="<div class='settName' id='"+s+"_div' style='display:block'>"+this.settings[s].name+" "+this.settings[s].html()+"</div>");return t}globalCMD(e){if(confirm(e))switch(e){case"save gameJS":return t.saveData("game_"+this.vars.build+".js",this.gameJS)}}generateSetting(e,t,s){switch(e){case"button":return`<input type="button" name="${e}" id="slid_utilities_${t}" class="settingsBtn" onclick="${s.function}" value="${s.label}" style="float:right;width:auto"/>`;case"checkbox":return`<label class="switch"><input type="checkbox" onclick="${this.hash}.setSetting('${t}', this.checked)" ${this.settings[t].val?"checked":""}><span class="slider"></span></label>`;case"slider":return`<span class='sliderVal' id='slid_utilities_${t}'>${this.settings[t].val}</span><div class='slidecontainer'><input type='range' min='${this.settings[t].min}' max='${this.settings[t].max}' step='${this.settings[t].step}' value='${this.settings[t].val}' class='sliderM' oninput="${this.hash}.setSetting('${t}', this.value)"></div>`;case"select":{let e=`<select onchange="${this.hash}.setSetting('${t}', this.value)" class="inputGrey2">`;for(let i in s)e+='<option value="'+i+'" '+(i==this.settings[t].val?"selected":"")+">"+s[i]+"</option>";return e+="</select>",e}default:return`<input type="${e}" name="${e}" id="slid_utilities_${t}"\n${"color"==e?'style="float:right;margin-top:5px"':`class="inputGrey2" placeholder="${s}"`}\nvalue="${this.settings[t].val}" oninput="${this.hash}.setSetting('${t}', this.value)"/>`}}setSetting(e,t){this.settings[e].val=t,this.saveVal(e,t),document.getElementById(`slid_utilities_${e}`)&&(document.getElementById(`slid_utilities_${e}`).innerHTML=t),this.settings[e].set&&this.settings[e].set(t)}saveVal(e,t){localStorage.setItem("krk_"+e,t)}deleteVal(e){localStorage.removeItem("krk_"+e)}getSavedVal(e){return localStorage.getItem("krk_"+e)}gameHooks(){t.waitFor((()=>this.exports)).then((e=>{let s={overlay:["render","canvas"],config:["accAnnounce","availableRegions","assetCat"],three:["ACESFilmicToneMapping","TextureLoader","ObjectLoader"]};for(let i in e){let a=e[i].exports;for(let e in s)t.objectHas(a,s[e])&&(console.info("Found Export ",e),delete s[e],this[e]=a)}if(0!==Object.keys(s).length||s.constructor!==Object)for(let e in s)alert("Failed To Find Export "+e);else{function i(e,s,i,n,o){a.overlay.canvas.width,a.overlay.canvas.height;const r=[e,s,i,n,o];r&&(i&&"object"==typeof a.settings&&a.settings.noInActivity.val&&(i.idleTimer=0,t.isDefined(a.config)&&(a.config.kickTimer=1/0)),o&&(o.active&&o.health&&i.update(),o.banned&&Object.assign(o,{banned:!1}),o.isHacker&&Object.assign(o,{isHacker:0}),o.kicked&&Object.assign(o,{kicked:!1}),o.kickedByVote&&Object.assign(o,{kickedByVote:!1}),o.account=Object.assign(o,{premiumT:!0}),["scale","game","controls","renderer","me"].forEach(((e,t)=>{a[e]=r[t]})),a.ctx.save(),a.ctx.scale(e,e),a.onRender(),a.ctx.restore()),t.isType(a.settings,"object")&&(a.settings.hasOwnProperty("autoActivateNuke")&&a.settings.autoActivateNuke.val&&a.me&&Object.keys(a.me.streaks).length&&a.wsSend("k",0),a.settings.hasOwnProperty("autoClick")&&a.settings.autoClick.val&&"none"==window.endUI.style.display&&"none"==window.windowHolder.style.display&&i.toggle(!0)))}Object.defineProperties(this.config,{nameVisRate:{value:0,writable:!1},serverTickFrequency:{value:60,writable:!1},syncRate:{value:0,writable:!1},hitBoxPad:{value:0,writable:!1}}),this.ray=new this.three.Raycaster,this.vec2=new this.three.Vector2(0,0),this.mesh=new Proxy({},{get:(e,t)=>(e[t]||(e[t]=new a.three.MeshBasicMaterial({transparent:!0,fog:!1,depthTest:!1,color:t})),e[t])}),this.ctx=this.overlay.canvas.getContext("2d"),this.overlay.render=new Proxy(this.overlay.render,{apply:function(e,t,s){return[e.apply(t,s),i.apply(t,s)]}})}}));const e=Symbol("origSkins"),s=Symbol("localSkins");Object.defineProperties(Object.prototype,{skins:{set(t){return this[e]=t,null!=this[s]&&this[s].length||(this[s]=Array.apply(null,Array(5e3)).map(((e,t)=>({ind:t,cnt:1})))),t},get(){return a.settings.skinUnlock.val&&this.stats?this[s]:this[e]}}}),t.waitFor((()=>this.ws)).then((()=>{this.wsEvent=this.ws._dispatchEvent.bind(this.ws),this.wsSend=this.ws.send.bind(this.ws),this.ws.send=new Proxy(this.ws.send,{apply:function(e,t,[s,...i]){if("ah2"!=s){if("en"==s){let e=i[0];e&&(a.skinData=Object.assign({},{main:e[2][0],secondary:e[2][1],hat:e[3],body:e[4],knife:e[9],dye:e[14],waist:e[17]}))}return e.apply(t,[s,...i])}}}),this.ws._dispatchEvent=new Proxy(this.ws._dispatchEvent,{apply:function(e,t,[s,...i]){if("init"==s){let e=i[0];e[10]&&e[10].bill&&a.settings&&a.settings.customBillboard.val.length>1&&(e[10].bill.txt=a.settings.customBillboard.val)}if("0"==s){let e=i[0][0],t=39;for(;e.length%t!=0;)t++;for(let s=0;s<e.length;s+=t)e[s]===a.ws.socketId&&(e[s+12]=[a.skinData.main,a.skinData.secondary],e[s+13]=a.skinData.hat,e[s+14]=a.skinData.body,e[s+19]=a.skinData.knife,e[s+24]=a.skinData.dye,e[s+33]=a.skinData.waist)}return"3"==s&&i[0][4]&&(i[0][4].wId=0,i[0][4].hs=!0,i[0][4].dst=1/0,i[0][4].wb=!0),e.apply(t,[s,...i])}})}))}gameLoad(){this.vars=t.getData(this.gameJS,{build:{regex:/\.exports='(\w{5})'/,index:1},inView:{regex:/&&!\w\.\w+&&\w\.\w+&&\w\.(\w+)\){/,index:1},spectating:{regex:/team:window\.(\w+)/,index:1},procInputs:{regex:/this\.(\w+)=function\(\w+,\w+,\w+,\w+\){this\.recon/,index:1},aimVal:{regex:/this\.(\w+)-=1\/\(this\.weapon\.aimSpd/,index:1},pchObjc:{regex:/0,this\.(\w+)=new \w+\.Object3D,this/,index:1},didShoot:{regex:/--,\w+\.(\w+)=!0/,index:1},nAuto:{regex:/'Single Fire',varN:'(\w+)'/,index:1},crouchVal:{regex:/this\.(\w+)\+=\w\.crouchSpd\*\w+,1<=this\.\w+/,index:1},recoilAnimY:{regex:/\.\w+=0,this\.(\w+)=0,this\.\w+=0,this\.\w+=1,this\.slide/,index:1},ammos:{regex:/length;for\(\w+=0;\w+<\w+\.(\w+)\.length/,index:1},weaponIndex:{regex:/\.weaponConfig\[\w+]\.secondary&&\(\w+\.(\w+)==\w+/,index:1},isYou:{regex:/this\.accid=0,this\.(\w+)=\w+,this\.isPlayer/,index:1},objInstances:{regex:/\w+\.\w+\(0,0,0\);if\(\w+\.(\w+)=\w+\.\w+/,index:1},getWorldPosition:{regex:/var \w+=\w+\.camera\.(\w+)\(\);/,index:1},mouseDownR:{regex:/this\.(\w+)=0,this\.keys=/,index:1},maxHealth:{regex:/\.regenDelay,this\.(\w+)=\w+\.mode&&\w+\.mode\.\1/,index:1},xDire:{regex:/this\.(\w+)=Math\.lerpAngle\(this\.xDir2/,index:1},yDire:{regex:/this\.(\w+)=Math\.lerpAngle\(this\.yDir2/,index:1},yVel:{regex:/this\.(\w+)=this\.\w+,this\.visible/,index:1}}),console.log(this.vars),new Function("WP_fetchMMToken","Module",this.hash,t.patchData(this.gameJS,{exports:{regex:/(this\.\w+\.\w+\(this\)}},function\(\w+,\w+,(\w+)\){)/,patch:`$1 ${this.hash}.exports=$2.c; ${this.hash}.modules=$2.m;`},inputs:{regex:/(\w+\.\w+\.\w+\?'\w+':'push'\]\()(\w+)\),/,patch:`$1${this.hash}.onInput($2)),`},inView:{regex:/&&(\w+\.\w+)\){(if\(\(\w+=\w+\.\w+\.\w+\.\w+)/,patch:`){if(void 0!==${this.hash}.noNameTags||!$1&&void 0 == ${this.hash}.nameTags)continue;$2`},socket:{regex:/this\.\w+=new WebSocket\(\w+\)/,patch:`${this.hash}.ws=this;$&`},isHacker:{regex:/(window\.\w+=)!0\)/,patch:"$1!1)"},respawnT:{regex:/\w+:1e3\*/g,patch:"respawnT:0*"},anticheat1:{regex:/&&\w+\(\),window\.utilities&&\(\w+\(null,null,null,!0\),\w+\(\)\)/,patch:""},anticheat3:{regex:/windows\.length>\d+.*?37/,patch:"37"},commandline:{regex:/Object\.defineProperty\(console.*?\),/,patch:""}}))(new Promise((e=>e(this.token))),{csv:async()=>0},this)}mainCustomRule(e,s){t.waitFor((()=>this.mainCustom)).then((()=>{const t=this.mainCustom.cssRules;if("insert"==e)this.mainCustom.insertRule(s);else if("delete"==e)for(let e=0;e<t.length;e++)t[e].cssText==s&&this.mainCustom.deleteRule(e);else console.error(e+" not Implemented for mainCustomRule")}))}displayStyle(e,s){t.waitFor((()=>window[e]),5e3).then((t=>{t?t.style.display=s?"none":"inherit":log.error(e," was not found in the window object")}))}stylesheets(){new Array(...document.styleSheets).map((e=>{if(e.href){let t=/http.*?krunker.io\/css\/(\w+.css).+/.exec(e.href);if(t&&t[1]){let s=t[1];s&&s.includes("main_custom")&&(this.mainCustom=e)}}}));let e=document.createElement("style");e.type="text/css",t.head.appendChild(e),Object.entries({tabStyle:".tab { overflow: hidden; border: 1px solid #ccc; background-image: linear-gradient(#2f3136, #f1f1f1, #2f3136); }",btnStyle:".tab button { background-color: inherit; float: left; border: none; outline: solid; cursor: pointer; padding: 14px 16px; transition: 0.3s; font-size: 17px; font-weight:500;color:black;text-shadow: 2px 2px #FFF;}",btnHoverStyle:".tab button:hover { background-color: #ddd; }",activeTabStyle:".tab button.active { background-color: #ccc; }",tabContentStyle:".tabcontent { display: none; padding: 6px 12px; border: 1px solid #ccc; border-top: none; animation: fadeEffect 1s; /* Fading effect takes 1 second */}",zeroToFullOpacity:"@keyframes fadeEffect { from {opacity: 0;} to {opacity: 1;} }",separator:".separator{display:flex;align-items:center;text-align:center}.separator::before,.separator::after{content:'';flex:1;border-bottom:1px solid #000}.separator:not(:empty)::before{margin-right:.25em}.separator:not(:empty)::after{margin-left:.25em}",discordWrapper:".wrapper{background:#2f3136;width:100%;}",discordContent:".content{display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row nowrap}",discordInfo:".guild-info{flex:1 1 auto;min-width:1px;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;flex-wrap:nowrap;display:flex;align-items:stretch;-webkit-box-align:stretch;justify-content:center;text-indent:0}",discordIcon:".guild-icon{background-color:#333;margin-right:16px;flex:0 0 auto;width:50px;height:50px;border-radius:15px;position:relative;background-clip:padding-box;background-position:50%;background-size:100% 100%}",discordDesc:".inv-desc{font-weight:700;margin:0;margin-bottom:12px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;color:#b9bbbe;text-transform:uppercase;font-size:12px;line-height:12px;flex:1}",discordName:".guild-name{flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:20px;align-items:center;display:flex;color:#FFF;font-weight:700}",discordNameHover:".guild-name:hover{cursor:pointer;text-decoration:underline}",discordBtn:".d-button{align-self:center;margin-left:10px;margin-top:4px;white-space:nowrap;flex:0 0 auto;position:relative;display:flex;justify-content:center;align-items:center;border-radius:3px;border:none;font-size:14px;font-weight:500;line-height:20px;height:43px;padding:2px 20px;user-select:none;transition:background-color .1s ease,color .1s ease;color:#FFF;background:#4B8;cursor:pointer}",discordBtnHover:".d-button:hover{background:#3A7;}",discordBtnLabel:".d-button-label{font-weight:500;color:white;text-shadow: 2px 2px #000;}",discordActive:".d-button:active{background:#396}",discordInvDest:".inviteDestination{margin:0}",discordDetail:".guildDetail{margin:0;font-size:14px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;color:#b9bbbe;line-height:16px}",discordStatusCounts:".statusCounts{display:flex;-webkit-box-align:center;align-items:center;font-weight:600}",discordStatus:".status{display:block;margin-right:4px;width:8px;height:8px;border-radius:50%;flex:0 0 auto;font-style:italic}",discordStatusOnline:".statusOnline{background:#43b581}",discordStatusOffline:".statusOffline{background:#747f8d}",discordCount:".count-30T-5k{-webkit-box-flex:0;flex:0 1 auto;margin-right:8px;color:#b9bbbe;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}"}).forEach((([t,s],i)=>{e.appendChild(document.createTextNode(s))}))}eventHandlers(){window.addEventListener("load",(e=>{console.log("page is fully loaded"),this.stylesheets(),t.waitFor((()=>document.querySelector("#instructionsUpdate")),5e3).then((e=>{if(!e)return console.error("Could not get instructions update");t.createObserver(e,"style",(e=>{this.settings.autoFindNew.val&&["Kicked","Banned","Disconnected","Error","Game is full"].some((t=>e&&e.innerHTML.includes(t)))&&(location=document.location.origin)}))})),window.addEventListener("keyup",(e=>{this.downKeys.has(e.code)&&this.downKeys.delete(e.code)})),window.addEventListener("keydown",(e=>{if("INPUT"!=document.activeElement.tagName)switch(e.code){case"F1":e.preventDefault(),this.toggleMenu();break;case"NumpadSubtract":document.exitPointerLock(),console.dir(window),console.dir(this);break;default:this.downKeys.has(e.code)||this.downKeys.add(e.code)}}))}))}getD3D(e,t,s,i,a,n){let o=e-i,r=t-a,l=s-n;return Math.sqrt(o*o+r*r+l*l)}getAngleDst(e,t){return Math.atan2(Math.sin(t-e),Math.cos(e-t))}getXDire(e,t,s,i,a,n){let o=Math.abs(t-a),r=this.getD3D(e,t,s,i,a,n);return Math.asin(o/r)*(t>a?-1:1)}getDir(e,t,s,i){return Math.atan2(t-i,e-s)}getDistance(e,t,s,i){return Math.sqrt((s-=e)*s+(i-=t)*i)}containsPoint(e){let t=this.renderer.frustum.planes;for(let s=0;s<6;s++)if(t[s].distanceToPoint(e)<0)return!1;return!0}getCanSee(e,t,s,i,a){if(!e)return 0;a=a||0;for(let n,o=this.getD3D(e.x,e.y,e.z,t,s,i),r=this.getDir(e.z,e.x,i,t),l=this.getDir(this.getDistance(e.x,e.z,t,i),s,0,e.y),h=1/(o*Math.sin(r-Math.PI)*Math.cos(l)),c=1/(o*Math.cos(r-Math.PI)*Math.cos(l)),d=1/(o*Math.sin(l)),m=e.y+(e.height||0)-this.consts.cameraHeight,u=0;u<this.game.map.manager.objects.length;++u)if(!(n=this.game.map.manager.objects[u]).noShoot&&n.active&&!n.transparent&&(!this.settings.wallPenetrate.val||!n.penetrable||!this.me.weapon.pierce)){let t=this.lineInRect(e.x,e.z,m,h,c,d,n.x-Math.max(0,n.width-a),n.z-Math.max(0,n.length-a),n.y-Math.max(0,n.height-a),n.x+Math.max(0,n.width-a),n.z+Math.max(0,n.length-a),n.y+Math.max(0,n.height-a));if(t&&1>t)return t}return null}lineInRect(e,t,s,i,a,n,o,r,l,h,c,d){let m=(o-e)*i,u=(h-e)*i,p=(l-s)*n,g=(d-s)*n,f=(r-t)*a,w=(c-t)*a,y=Math.max(Math.max(Math.min(m,u),Math.min(p,g)),Math.min(f,w)),x=Math.min(Math.min(Math.max(m,u),Math.max(p,g)),Math.max(f,w));return!(x<0)&&!(y>x)&&y}lookDir(e,t){e/=1e3,t/=1e3,this.controls.object.rotation.y=t,this.controls[this.vars.pchObjc].rotation.x=e,this.controls[this.vars.pchObjc].rotation.x=Math.max(-this.consts.halfPI,Math.min(this.consts.halfPI,this.controls[this.vars.pchObjc].rotation.x)),this.controls.yDr=(this.controls[this.vars.pchObjc].rotation.x%Math.PI).round(3),this.controls.xDr=(this.controls.object.rotation.y%Math.PI).round(3),this.renderer.camera.updateProjectionMatrix(),this.renderer.updateFrustum()}resetLookAt(){this.controls.yDr=this.controls[this.vars.pchObjc].rotation.x,this.controls.xDr=this.controls.object.rotation.y,this.renderer.camera.updateProjectionMatrix(),this.renderer.updateFrustum()}world2Screen(e){let t=e.clone(),s=this.ctx.canvas.width/this.scale,i=this.ctx.canvas.height/this.scale;return t.project(this.renderer.camera),t.x=(t.x+1)/2,t.y=(1-t.y)/2,t.x*=s,t.y*=i,t}getInView(e){return null==this.getCanSee(this.me,e.x,e.y,e.z)}getIsFriendly(e){return(this.me&&this.me.team?this.me.team:this.me.spectating?1:0)==e.team}};e.source().then((t=>{a.gameJS=t,e.c=a.discord.code,e.token().then((e=>a.token=e))}));let n=new MutationObserver((e=>{for(let t of e)for(let e of t.addedNodes)"SCRIPT"===e.tagName&&("text/javascript"===e.type&&e.innerHTML.startsWith("*!",1)?(e.innerHTML="window._debugTimeStart=Date.now()",n.disconnect()):e.src)}));n.observe(document,{childList:!0,subtree:!0})})()})();