(function(f){function n(a){var b=f[a.codecClass],d=a.sn;if(g[d])throw Error("duplicated sn");g[d]={codec:new b(a.options),crcInput:"input"===a.crcType,crcOutput:"output"===a.crcType,crc:new h};postMessage({type:"newTask",sn:d})}function p(a){var b=a.sn,d=a.type,c=a.data,e=g[b];!e&&a.codecClass&&(n(a),e=g[b]);a="append"===d;var f=l();if(a)try{var k=e.codec.append(c,function(a){postMessage({type:"progress",sn:b,loaded:a})})}catch(q){throw delete g[b],q;}else delete g[b],k=e.codec.flush();var h=l()-
f;f=l();c&&e.crcInput&&e.crc.append(c);k&&e.crcOutput&&e.crc.append(k);c=l()-f;d={type:d,sn:b,codecTime:h,crcTime:c};c=[];k&&(d.data=k,c.push(k.buffer));a||!e.crcInput&&!e.crcOutput||(d.crc=e.crc.get());try{postMessage(d,c)}catch(q){postMessage(d)}}function h(){this.crc=-1}function m(){}if(f.zWorkerInitialized)throw Error("z-worker.js should be run only once");f.zWorkerInitialized=!0;addEventListener("message",function(a){a=a.data;var b=a.type,d=a.sn,c=r[b];if(c)try{c(a)}catch(e){postMessage({type:b,
sn:d,error:{message:e.message,stack:e.stack}})}});var r={importScripts:function(a){a.scripts&&0<a.scripts.length&&importScripts.apply(void 0,a.scripts);postMessage({type:"importScripts"})},newTask:n,append:p,flush:p},g={},l=f.performance?f.performance.now.bind(f.performance):Date.now;h.prototype.append=function(a){for(var b=this.crc|0,d=this.table,c=0,e=a.length|0;c<e;c++)b=b>>>8^d[(b^a[c])&255];this.crc=b};h.prototype.get=function(){return~this.crc};h.prototype.table=function(){var a,b,d=[];for(a=
0;256>a;a++){var c=a;for(b=0;8>b;b++)c=c&1?c>>>1^3988292384:c>>>1;d[a]=c}return d}();f.NOOP=m;m.prototype.append=function(a,b){return a};m.prototype.flush=function(){}})(this);
